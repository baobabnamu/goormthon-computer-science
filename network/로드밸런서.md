# Load Balancer ✅

## Load Balancer 에 대한 간단한 개념, 우리가 왜 알아야 할까?

![image.png](Load%20Balancer%20%E2%9C%85%2020018fdf38ed803b8246db70fce153d8/image.png)

- Load Balancer? → Load Balancing을 수행하는 무언가.
- Load Balancing? → 클라이언트와 서버 그룹 사이에 위치해서 서버에 가해지는 트래픽을 여러 대의 서버에 **분배**하여 특정 서버의 **부하를 덜어줌.**
- 어려운 기술 메커니즘은 없으나 실무에서 잘 사용되는 기술이므로 꼭 숙지해야 함.

## Load Balancer 에 대해

### Load Balancing Algorithm : 어떤 기준으로 분배할거야?

**정적 알고리즘 (Static Algorithms)**

**라운드 로빈(Round Robin) :** 요청을 서버 그룹에 순차적으로 분산시킴 (즉, 동일 사용자의 여러 요청이 같은 인스턴스로 전달될 것이라는 보장은 없음)

**스티키 라운드 로빈(Sticky Round Robin) :** 라운드 로빈의 단점을 보완한 방식 (동일 사용자로부터 발생한 요청은 항상 같은 인스턴스로 전달됨)

**해시 기반(Hash-Based) :** 요청의 해시 키 값을 기준으로 분산 처리 (이때, 해시 키는 IP 주소나 요청의 URL 등이 될 수 있음)

**가중치 라운드 로빈(Weighted Round Robin) :** 각 서버에 가중치(Weight)를 부여하여 트래픽 분산 (가중치가 높은 서버에 더 많은 요청이 전달됨) → 서버마다 처리 능력이 다른 환경에 적합

![load balancing.gif](Load%20Balancer%20%E2%9C%85%2020018fdf38ed803b8246db70fce153d8/load_balancing.gif)

- **그러나,**
    
    정적 알고리즘은 초기에 설정해놨던 설정 값을 기준으로 동작함.
    예측 가능한 트래픽에는 효과적일 수 있으나, 갑작스러운 트래픽이 튀었을 때 대응이 어려움.
    

**동적 알고리즘 (Dynamic Algorithms)**

**최소 연결 수(Least Connections) :** 현재 연결 수가 가장 적은 서버로 요청을 전달 (서버의 상대적인 컴퓨팅 성능을 고려하여 연결 수를 판단함)

**최소 응답 시간(Least Response Time) :** 응답 시간이 가장 짧은 서버로 요청을 전달 (응답 시간이 중요한 환경에서 유용함)

### **하지만,**

알고리즘만으로는 대량의 리소스를 감당하기에는 쉽지 않음.

그래서 용도를 구분해서 로드밸런서의 유형을 분리하게 됨.

### Load Balancer Type : L4와 L7 로드밸런서

- **핵심 차이점…**
    
    같은 HTTP 트래픽이 인입됐을 때
    
    - L4 : TCP 패킷을 서버에 라우팅
    - L7 : TCP 패킷을 열어 HTTP 메서드 등 정보를 확인해 핸들링하고 적절하게 라우팅

**L4 로드밸런서 (L4 Load Balancer)**

- L4 로드밸런서는 OSI 7계층 중 전송 계층(Transport Layer)에서 동작하며, 주로 TCP/UDP 프로토콜의 IP 주소와 포트 정보를 기반으로 트래픽을 여러 서버로 분산
- 패킷의 헤더 정보만을 확인하기 때문에 처리 속도가 빠르고 효율적이며, 실시간 트래픽 처리나 단순 분산이 필요한 서비스에 적합
- 다만, 애플리케이션 계층의 정보(예: URL, 쿠키 등)는 인식하지 못해 세밀한 라우팅이나 다양한 정책 적용에는 한계가 있음.

![image.png](Load%20Balancer%20%E2%9C%85%2020018fdf38ed803b8246db70fce153d8/image%201.png)

**L7 로드밸런서 (L7 Load Balancer)**

- 애플리케이션 계층(Application Layer)에서 동작
- HTTP/HTTPS 등 프로토콜의 요청 내용(예: URL, 헤더, 쿠키, 페이로드 등)을 분석해 트래픽을 분산
    - 이를 통해 특정 경로나 리소스, 사용자 속성에 따라 세밀한 라우팅, 캐싱, 압축, 비정상 트래픽 필터링 등 다양한 기능을 제공
    - 패킷의 내용을 분석해야 하므로 L4에 비해 처리 속도가 느리고, 비용이나 리소스 소모가 더 큼.

![image.png](Load%20Balancer%20%E2%9C%85%2020018fdf38ed803b8246db70fce153d8/image%202.png)

- **그래서 무엇을 사용해야 할까?**
    - L4는 빠르고 단순한 트래픽 분산
    - L7은 세밀하고 유연한 애플리케이션 레벨 분산
    - 사실 실무에서는 함께 사용.


이미지 등이 깨지는 것을 우려해 노션 주소도 함께 공유합니다.
- https://baobab-tree.notion.site/Load-Balancer-20018fdf38ed803b8246db70fce153d8?pvs=74